# Generated by Otto, do not edit!
#
# This is the Vagrantfile generated by Otto for building the
# binary that is used as a dependency for development.
#
# Do not hand-edit this file. To modify this, use the Appfile.

Vagrant.configure("2") do |config|
  config.vm.box = "hashicorp/precise64"

  # Setup a synced folder from our working directory to /vagrant
  config.vm.synced_folder "{{ path.working }}", "/vagrant"

  # Setup a synced folder from where our compiled data is to
  # /otto. We do this to access the build script.
  config.vm.synced_folder "{{ path.compiled }}/dev-dep/build", "/otto"

  # Install Go build environment
  config.vm.provision "shell", inline: $script_golang
end

$script_golang = <<SCRIPT
set -e

echo "Downloading Go..."
wget -q -O /home/vagrant/go.tar.gz https://storage.googleapis.com/golang/go1.4.2.linux-amd64.tar.gz

echo "Untarring Go..."
sudo tar -C /usr/local -xzf /home/vagrant/go.tar.gz
rm /home/vagrant/go.tar.gz

echo "Making GOPATH..."
sudo mkdir -p /opt/gopath
sudo chown `whoami`:`whoami` /opt/gopath

echo "Setting up PATH..."
echo 'export PATH=/opt/gopath/bin:/usr/local/go/bin:$PATH' >> /home/vagrant/.bashrc
echo 'export GOPATH=/opt/gopath' >> /home/vagrant/.bashrc

echo "Installing VCSs for go get..."
sudo apt-get update -y >/dev/null 2>&1
sudo apt-get install -y git bzr mercurial
SCRIPT
